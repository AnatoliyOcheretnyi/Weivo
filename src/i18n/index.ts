import i18n from 'i18next';
import { initReactI18next, useTranslation } from 'react-i18next';
import { useEffect, useMemo } from 'react';
import * as Localization from 'expo-localization';

import type { Language } from '@/features/profile';

export type Locale = 'en' | 'uk' | 'es';
export type LanguageOption = Language | 'system';

const DEFAULT_LOCALE: Locale = 'en';
const SUPPORTED_LOCALES: Locale[] = ['en', 'uk', 'es'];

const normalizeLocale = (rawLocale?: string | null): Locale => {
  const normalized = rawLocale?.toLowerCase();
  const base = normalized?.split(/[-_]/)[0] as Locale | undefined;
  return base && SUPPORTED_LOCALES.includes(base) ? base : DEFAULT_LOCALE;
};

export const getSystemLocale = (): Locale => {
  const locales = Localization.getLocales?.();
  const languageTag = locales?.[0]?.languageTag ?? Localization.locale;
  return normalizeLocale(languageTag);
};

const translations = {
  en: {
    appName: 'Weivo',
    tabs: {
      profile: 'Profile',
      home: 'Home',
      explore: 'Explore',
      add: 'Add',
    },
    profile: {
      title: 'Profile',
      subtitle: 'Personal data, goals, and health metrics.',
      edit: 'Edit',
      sections: {
        basics: 'Basics',
        metrics: 'Health metrics',
        goal: 'Goal',
        preferences: 'Preferences',
        support: 'Support',
        segments: 'Segments',
      },
      fields: {
        birthDate: 'Birth date',
        sex: 'Sex',
        age: 'Age',
        height: 'Height',
        currentWeight: 'Current weight',
        bmi: 'BMI',
        calories: 'Calories',
        caloriesMaintenance: 'Maintenance',
        caloriesTarget: 'Target',
        activity: 'Activity',
        goalType: 'Goal type',
        goalTarget: 'Target weight',
        goalRate: 'Weekly pace',
        goalRange: 'Target range',
        prediction: 'Prediction',
        units: 'Units',
        language: 'Language',
        theme: 'Theme',
        feedback: 'Feedback',
      },
      actions: {
        addSegment: 'Add segment',
      },
      values: {
        notSet: 'Not set',
        unitsMetric: 'Metric (kg, cm)',
        unitsImperial: 'Imperial (lb, ft)',
        languageSoon: 'Soon',
        languageSystem: 'System',
        themeSoon: 'Soon',
        themeLight: 'Light',
        themeDark: 'Dark',
        themeRose: 'Rose',
        themeSky: 'Sky',
        themeMint: 'Mint',
        goalLose: 'Lose weight',
        goalGain: 'Gain weight',
        goalMaintain: 'Maintain',
        feedbackLink: 'Telegram',
        sexMale: 'Male',
        sexFemale: 'Female',
        caloriesMaintenance: 'Maintenance',
        caloriesTarget: 'Target',
        inRange: 'In range',
        activitySedentary: 'Sed',
        activityLight: 'Light',
        activityModerate: 'Mod',
        activityActive: 'Active',
        activityVeryActive: 'V-Act',
        activitySedentaryDesc: 'Desk work, minimal movement.',
        activityLightDesc: 'Light walks 1‚Äì2x per week.',
        activityModerateDesc: 'Training 2‚Äì3x per week.',
        activityActiveDesc: 'Training 4‚Äì5x per week.',
        activityVeryActiveDesc: 'Hard training, physical job.',
      },
    },
    profileEdit: {
      title: 'Edit profile',
      subtitle: 'Update your personal data and goals.',
      tabs: {
        profile: 'Profile',
        account: 'Account',
      },
      birthDate: 'Birth date',
      birthDatePlaceholder: 'Select date',
      sex: 'Sex',
      height: 'Height (cm)',
      activity: 'Activity level',
      goalType: 'Goal type',
      goalTarget: 'Target weight',
      goalRate: 'Pace',
      goalRange: 'Target range (kg)',
      units: 'Units',
      language: 'Language',
      theme: 'Theme',
      themeOptions: {
        light: 'Light',
        dark: 'Dark',
        rose: 'Rose',
        sky: 'Sky',
        mint: 'Mint',
      },
      currentWeight: 'Current',
      save: 'Save',
      cancel: 'Cancel',
    },
    modal: {
      title: 'New weigh-in',
      subtitle: "Add today's value and optional mood.",
      placeholderWeight: '0.0',
      moodLabel: 'Mood (optional)',
      cancel: 'Cancel',
      save: 'Save',
      addEntryTitle: 'Add entry',
    },
    home: {
      tagline: 'Weight journey - steady, honest, real',
      currentWeight: 'Current weight',
      trendingDown: 'Trending down',
      trendingUp: 'Trending up',
      lowest: 'Lowest',
      highest: 'Highest',
      entries: 'Entries',
      deltaSuffix: 'kg / 10 days',
      goal: 'Goal',
      eta: 'ETA',
      bmi: 'BMI',
      segmentsHintTitle: 'Your goal segments',
      segmentsHintBody:
        'Split your goal into small steps. Each segment keeps you focused and shows progress clearly. Create your first segment now, or do it later in Profile.',
      segmentsHintCta: 'Create first segment',
      segmentsHintDismiss: 'Later',
      units: {
        kg: 'kg',
        days: 'days',
        weeksShort: 'wk',
      },
    },
    chart: {
      title: 'Weight Flow',
      subtitleSuffix: 'days - daily log',
      start: 'Start',
      latest: 'Latest',
      unit: 'kg',
    },
    entries: {
      title: 'All entries',
      recordsSuffix: 'records',
      dailyLog: 'Daily log',
      deltaZero: '0.0',
      unit: 'kg',
      clearAll: 'Clear all',
      clearAllTitle: 'Clear all entries?',
      clearAllMessage: 'This will permanently remove every saved weigh-in.',
      clearAllConfirm: 'Clear',
      clearAllCancel: 'Cancel',
      deleteTitle: 'Delete entry?',
      deleteMessage: 'This entry will be removed permanently.',
      deleteConfirm: 'Delete',
      deleteCancel: 'Cancel',
    },
    segments: {
      createTitle: 'New segment',
      createSubtitle: 'Break your goal into meaningful steps.',
      done: 'Done',
      direction: 'Direction',
      mode: 'Mode',
      modeDelta: 'By kg',
      modeTarget: 'Target weight',
      modeHelper: 'Choose how you want to define this step.',
      startWeight: 'Start weight',
      delta: 'Change',
      targetWeight: 'Target weight',
      note: 'Note (optional)',
      notePlaceholder: 'Example: this was my weight 4 years ago',
      save: 'Save',
      cancel: 'Cancel',
      empty: 'No segments yet',
      detailTitle: 'Segment',
      detailSubtitle: 'Update or remove this segment.',
      detailMissing: 'Segment not found.',
      completedTitle: 'Segment completed',
      completedMessage: 'Completed segments are read-only.',
      deleteTitle: 'Delete segment?',
      deleteMessage: 'This segment will be removed permanently.',
      deleteConfirm: 'Delete',
      deleteCancel: 'Cancel',
      editBlockedTitle: 'Segment order',
      editBlockedMessage: 'Update the latest segment first to avoid breaking the chain.',
    },
    symbols: {
      plus: '+',
    },
    moods: {
      happy: 'üôÇ',
      neutral: 'üòê',
      sad: 'üòî',
      angry: 'üò†',
    },
    greeting: {
      wave: 'üëã',
    },
    onboarding: {
      title: 'Welcome',
      subtitle: 'Let us set up the essentials before you start.',
      welcomeTitle: 'Weivo is your weight flow.',
      welcomeBody:
        "Hey! I'm glad to help you get started. This is the first version, and more is on the way. Thanks for trying it out ‚Äî I'd really appreciate your feedback and ideas, and I'll do my best to bring them to life.",
      welcomeExtra:
        'This app helps you track your weight in a way that keeps you motivated and focused on your goals.',
      ageTitle: 'Your birth date.',
      ageBody:
        'For more accurate calculations ‚Äî and maybe to surprise you with a birthday hello.',
      birthDate: 'Birth date',
      birthDatePlaceholder: 'Select date',
      birthDateHelper: 'Only for calculations, never shared.',
      sex: 'Sex',
      bodyTitle: 'Body metrics.',
      bodyBody:
        'To calculate your trends and targets as accurately as possible, please share these details and your activity level below.',
      height: 'Height',
      weight: 'Current weight',
      bodyHelper: 'You can update this anytime.',
      activityHint: 'Scroll down for activity level.',
      goalTitle: 'What is your goal?',
      goalBody: 'Pick a target and a weekly pace that feels sustainable.',
      goalType: 'Goal type',
      targetWeight: 'Target weight',
      weeklyPace: 'Weekly pace',
      weeklyPaceLoseHelper: 'Up to 1.0 kg per week.',
      weeklyPaceGainHelper: 'Up to 0.5 kg per week.',
      targetRange: 'Target range',
      activity: 'Activity level',
      next: 'Next',
      back: 'Back',
      finish: 'Finish',
      stepLabel: 'Step {current} of {total}',
    },
  },
  uk: {
    appName: 'Weivo',
    tabs: {
      profile: '–ü—Ä–æ—Ñ—ñ–ª—å',
      home: '–ì–æ–ª–æ–≤–Ω–∞',
      explore: '–ó–∞–ø–∏—Å–∏',
      add: '–î–æ–¥–∞—Ç–∏',
    },
    profile: {
      title: '–ü—Ä–æ—Ñ—ñ–ª—å',
      subtitle: '–û—Å–æ–±–∏—Å—Ç—ñ –¥–∞–Ω—ñ, —Ü—ñ–ª—ñ —Ç–∞ –º–µ—Ç—Ä–∏–∫–∏ –∑–¥–æ—Ä–æ–≤ º—è.',
      edit: '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏',
      sections: {
        basics: '–û—Å–Ω–æ–≤–Ω–µ',
        metrics: '–ú–µ—Ç—Ä–∏–∫–∏ –∑–¥–æ—Ä–æ–≤ º—è',
        goal: '–¶—ñ–ª—å',
        preferences: '–ù–∞–ª–∞—à—Ç—É–≤–∞–Ω–Ω—è',
        support: '–ü—ñ–¥—Ç—Ä–∏–º–∫–∞',
        segments: '–í—ñ–¥—Ä—ñ–∑–∫–∏',
      },
      fields: {
        birthDate: '–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è',
        sex: '–°—Ç–∞—Ç—å',
        age: '–í—ñ–∫',
        height: '–ó—Ä—ñ—Å—Ç',
        currentWeight: '–ü–æ—Ç–æ—á–Ω–∞ –≤–∞–≥–∞',
        bmi: '–Ü–ú–¢',
        calories: '–ö–∞–ª–æ—Ä—ñ—ó',
        caloriesMaintenance: '–ü—ñ–¥—Ç—Ä–∏–º–∫–∞',
        caloriesTarget: '–¶—ñ–ª—å',
        activity: '–ê–∫—Ç–∏–≤–Ω—ñ—Å—Ç—å',
        goalType: '–¢–∏–ø —Ü—ñ–ª—ñ',
        goalTarget: '–¶—ñ–ª—å–æ–≤–∞ –≤–∞–≥–∞',
        goalRate: '–¢–µ–º–ø –∑–∞ —Ç–∏–∂–¥–µ–Ω—å',
        goalRange: '–¶—ñ–ª—å–æ–≤–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω',
        prediction: '–ü—Ä–æ–≥–Ω–æ–∑',
        units: '–û–¥–∏–Ω–∏—Ü—ñ',
        language: '–ú–æ–≤–∞',
        theme: '–¢–µ–º–∞',
        feedback: '–ó–≤–æ—Ä–æ—Ç–Ω–∏–π –∑–≤ º—è–∑–æ–∫',
      },
      actions: {
        addSegment: '–î–æ–¥–∞—Ç–∏',
      },
      values: {
        notSet: '–ù–µ –∑–∞–¥–∞–Ω–æ',
        unitsMetric: '–ú–µ—Ç—Ä–∏—á–Ω—ñ (–∫–≥, —Å–º)',
        unitsImperial: '–Ü–º–ø–µ—Ä—Å—å–∫—ñ (lb, ft)',
        languageSoon: '–°–∫–æ—Ä–æ',
        languageSystem: '–°–∏—Å—Ç–µ–º–∞',
        themeSoon: '–°–∫–æ—Ä–æ',
        themeLight: '–°–≤—ñ—Ç–ª–∞',
        themeDark: '–¢–µ–º–Ω–∞',
        themeRose: '–†–æ–∂–µ–≤–∞',
        themeSky: '–ë–ª–∞–∫–∏—Ç–Ω–∞',
        themeMint: '–ú º—è—Ç–∞',
        goalLose: '–°—Ö—É–¥–Ω—É—Ç–∏',
        goalGain: '–ù–∞–±—Ä–∞—Ç–∏ –≤–∞–≥—É',
        goalMaintain: '–ü—ñ–¥—Ç—Ä–∏–º–∫–∞',
        feedbackLink: 'Telegram',
        sexMale: '–ß–æ–ª–æ–≤—ñ—á–∞',
        sexFemale: '–ñ—ñ–Ω–æ—á–∞',
        caloriesMaintenance: '–ü—ñ–¥—Ç—Ä–∏–º–∫–∞',
        caloriesTarget: '–¶—ñ–ª—å',
        inRange: '–í –º–µ–∂–∞—Ö',
        activitySedentary: '–°–∏–¥',
        activityLight: '–õ–µ–≥–∫',
        activityModerate: '–ü–æ–º—ñ—Ä',
        activityActive: '–ê–∫—Ç–∏–≤',
        activityVeryActive: '–î—É–∂–µ',
        activitySedentaryDesc: '–û—Ñ—ñ—Å–Ω–∞ —Ä–æ–±–æ—Ç–∞, –º—ñ–Ω—ñ–º—É–º —Ä—É—Ö—É.',
        activityLightDesc: '–õ–µ–≥–∫—ñ –ø—Ä–æ–≥—É–ª—è–Ω–∫–∏ 1‚Äì2 —Ä–∞–∑–∏ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.',
        activityModerateDesc: '–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è 2‚Äì3 —Ä–∞–∑–∏ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.',
        activityActiveDesc: '–¢—Ä–µ–Ω—É–≤–∞–Ω–Ω—è 4‚Äì5 —Ä–∞–∑—ñ–≤ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.',
        activityVeryActiveDesc: '–Ü–Ω—Ç–µ–Ω—Å–∏–≤–Ω—ñ —Ç—Ä–µ–Ω—É–≤–∞–Ω–Ω—è –∞–±–æ —Ñ—ñ–∑–∏—á–Ω–∞ —Ä–æ–±–æ—Ç–∞.',
      },
    },
    profileEdit: {
      title: '–†–µ–¥–∞–≥—É–≤–∞—Ç–∏ –ø—Ä–æ—Ñ—ñ–ª—å',
      subtitle: '–û–Ω–æ–≤—ñ—Ç—å –æ—Å–æ–±–∏—Å—Ç—ñ –¥–∞–Ω—ñ —Ç–∞ —Ü—ñ–ª—ñ.',
      tabs: {
        profile: '–ü—Ä–æ—Ñ—ñ–ª—å',
        account: '–ê–∫–∞—É–Ω—Ç',
      },
      birthDate: '–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è',
      birthDatePlaceholder: '–û–±–µ—Ä—ñ—Ç—å –¥–∞—Ç—É',
      sex: '–°—Ç–∞—Ç—å',
      height: '–ó—Ä—ñ—Å—Ç (—Å–º)',
      activity: '–†—ñ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ',
      goalType: '–¢–∏–ø —Ü—ñ–ª—ñ',
      goalTarget: '–¶—ñ–ª—å–æ–≤–∞ –≤–∞–≥–∞',
      goalRate: '–¢–µ–º–ø',
      goalRange: '–¶—ñ–ª—å–æ–≤–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω (–∫–≥)',
      units: '–û–¥–∏–Ω–∏—Ü—ñ',
      language: '–ú–æ–≤–∞',
      theme: '–¢–µ–º–∞',
      themeOptions: {
        light: '–°–≤—ñ—Ç',
        dark: '–¢–µ–º–Ω',
        rose: '–†–æ–∂',
        sky: '–ë–ª–∞–∫',
        mint: '–ú º—è—Ç',
      },
      currentWeight: '–ü–æ—Ç–æ—á–Ω–∞',
      save: '–ó–±–µ—Ä–µ–≥—Ç–∏',
      cancel: '–°–∫–∞—Å—É–≤–∞—Ç–∏',
    },
    modal: {
      title: '–ù–æ–≤–µ –∑–≤–∞–∂—É–≤–∞–Ω–Ω—è',
      subtitle: '–î–æ–¥–∞–π—Ç–µ —Å—å–æ–≥–æ–¥–Ω—ñ—à–Ω—î –∑–Ω–∞—á–µ–Ω–Ω—è —Ç–∞ –Ω–∞—Å—Ç—Ä—ñ–π (–æ–ø—Ü—ñ–π–Ω–æ).',
      placeholderWeight: '0.0',
      moodLabel: '–ù–∞—Å—Ç—Ä—ñ–π (–æ–ø—Ü—ñ–π–Ω–æ)',
      cancel: '–°–∫–∞—Å—É–≤–∞—Ç–∏',
      save: '–ó–±–µ—Ä–µ–≥—Ç–∏',
      addEntryTitle: '–î–æ–¥–∞—Ç–∏ –∑–∞–ø–∏—Å',
    },
    home: {
      tagline: '–í–∞–≥–∞: —Å—Ç–∞–±—ñ–ª—å–Ω–æ, —á–µ—Å–Ω–æ, —Ä–µ–∞–ª—å–Ω–æ',
      currentWeight: '–ü–æ—Ç–æ—á–Ω–∞ –≤–∞–≥–∞',
      trendingDown: '–°–ø–∞–¥–∞—î',
      trendingUp: '–ó—Ä–æ—Å—Ç–∞—î',
      lowest: '–ú—ñ–Ω—ñ–º—É–º',
      highest: '–ú–∞–∫—Å–∏–º—É–º',
      entries: '–ó–∞–ø–∏—Å—ñ–≤',
      deltaSuffix: '–∫–≥ / 10 –¥–Ω—ñ–≤',
      goal: '–¶—ñ–ª—å',
      eta: '–ß–∞—Å',
      bmi: '–Ü–ú–¢',
      segmentsHintTitle: '–í—ñ–¥—Ä—ñ–∑–∫–∏ —Ü—ñ–ª—ñ',
      segmentsHintBody:
        '–†–æ–∑–±–∏–π —Ü—ñ–ª—å –Ω–∞ –Ω–µ–≤–µ–ª–∏–∫—ñ –∫—Ä–æ–∫–∏. –¢–∞–∫ –ª–µ–≥—à–µ —Ç—Ä–∏–º–∞—Ç–∏ —Ñ–æ–∫—É—Å —ñ –±–∞—á–∏—Ç–∏ –ø—Ä–æ–≥—Ä–µ—Å. –°—Ç–≤–æ—Ä–∏ –ø–µ—Ä—à–∏–π –≤—ñ–¥—Ä—ñ–∑–æ–∫ –∑–∞—Ä–∞–∑ –∞–±–æ –ø—ñ–∑–Ω—ñ—à–µ —É –ø—Ä–æ—Ñ—ñ–ª—ñ.',
      segmentsHintCta: '–°—Ç–≤–æ—Ä–∏—Ç–∏ –ø–µ—Ä—à–∏–π –≤—ñ–¥—Ä—ñ–∑–æ–∫',
      segmentsHintDismiss: '–ü—ñ–∑–Ω—ñ—à–µ',
      units: {
        kg: '–∫–≥',
        days: '–¥–Ω—ñ–≤',
        weeksShort: '—Ç–∏–∂',
      },
    },
    chart: {
      title: '–î–∏–Ω–∞–º—ñ–∫–∞ –≤–∞–≥–∏',
      subtitleSuffix: '–¥–Ω—ñ–≤ - —â–æ–¥–µ–Ω–Ω–∏–π –ª–æ–≥',
      start: '–ü–æ—á–∞—Ç–æ–∫',
      latest: '–û—Å—Ç–∞–Ω–Ω—î',
      unit: '–∫–≥',
    },
    entries: {
      title: '–í—Å—ñ –∑–∞–ø–∏—Å–∏',
      recordsSuffix: '–∑–∞–ø–∏—Å—ñ–≤',
      dailyLog: '–©–æ–¥–µ–Ω–Ω–∏–π –ª–æ–≥',
      deltaZero: '0.0',
      unit: '–∫–≥',
      clearAll: '–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å–µ',
      clearAllTitle: '–û—á–∏—Å—Ç–∏—Ç–∏ –≤—Å—ñ –∑–∞–ø–∏—Å–∏?',
      clearAllMessage: '–¶–µ –Ω–∞–∑–∞–≤–∂–¥–∏ –≤–∏–¥–∞–ª–∏—Ç—å —É—Å—ñ –∑–≤–∞–∂—É–≤–∞–Ω–Ω—è.',
      clearAllConfirm: '–û—á–∏—Å—Ç–∏—Ç–∏',
      clearAllCancel: '–°–∫–∞—Å—É–≤–∞—Ç–∏',
      deleteTitle: '–í–∏–¥–∞–ª–∏—Ç–∏ –∑–∞–ø–∏—Å?',
      deleteMessage: '–ó–∞–ø–∏—Å –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ –Ω–∞–∑–∞–≤–∂–¥–∏.',
      deleteConfirm: '–í–∏–¥–∞–ª–∏—Ç–∏',
      deleteCancel: '–°–∫–∞—Å—É–≤–∞—Ç–∏',
    },
    segments: {
      createTitle: '–ù–æ–≤–∏–π –≤—ñ–¥—Ä—ñ–∑–æ–∫',
      createSubtitle: '–ü–æ–¥—ñ–ª–∏ —Ü—ñ–ª—å –Ω–∞ –¥–æ—Å—è–∂–Ω—ñ –∫—Ä–æ–∫–∏.',
      done: '–ì–æ—Ç–æ–≤–æ',
      direction: '–ù–∞–ø—Ä—è–º',
      mode: '–†–µ–∂–∏–º',
      modeDelta: '–ó–∞ –∫–≥',
      modeTarget: '–î–æ –≤–∞–≥–∏',
      modeHelper: '–û–±–µ—Ä–∏, —è–∫ —Ö–æ—á–µ—à –∑–∞–¥–∞—Ç–∏ —Ü–µ–π –∫—Ä–æ–∫.',
      startWeight: '–°—Ç–∞—Ä—Ç–æ–≤–∞ –≤–∞–≥–∞',
      delta: '–ó–º—ñ–Ω–∞',
      targetWeight: '–¶—ñ–ª—å–æ–≤–∞ –≤–∞–≥–∞',
      note: '–ö–æ–º–µ–Ω—Ç–∞—Ä (–æ–ø—Ü—ñ–π–Ω–æ)',
      notePlaceholder: '–ù–∞–ø—Ä–∏–∫–ª–∞–¥: —Ç–∞–∫ –≤–∞–∂–∏–≤ 4 —Ä–æ–∫–∏ —Ç–æ–º—É',
      save: '–ó–±–µ—Ä–µ–≥—Ç–∏',
      cancel: '–°–∫–∞—Å—É–≤–∞—Ç–∏',
      empty: '–©–µ –Ω–µ–º–∞—î –≤—ñ–¥—Ä—ñ–∑–∫—ñ–≤',
      detailTitle: '–í—ñ–¥—Ä—ñ–∑–æ–∫',
      detailSubtitle: '–û–Ω–æ–≤–∏ –∞–±–æ –≤–∏–¥–∞–ª–∏ —Ü–µ–π –≤—ñ–¥—Ä—ñ–∑–æ–∫.',
      detailMissing: '–í—ñ–¥—Ä—ñ–∑–æ–∫ –Ω–µ –∑–Ω–∞–π–¥–µ–Ω–æ.',
      completedTitle: '–í—ñ–¥—Ä—ñ–∑–æ–∫ –∑–∞–≤–µ—Ä—à–µ–Ω–æ',
      completedMessage: '–ó–∞–≤–µ—Ä—à–µ–Ω—ñ –≤—ñ–¥—Ä—ñ–∑–∫–∏ –¥–æ—Å—Ç—É–ø–Ω—ñ –ª–∏—à–µ –¥–ª—è –ø–µ—Ä–µ–≥–ª—è–¥—É.',
      deleteTitle: '–í–∏–¥–∞–ª–∏—Ç–∏ –≤—ñ–¥—Ä—ñ–∑–æ–∫?',
      deleteMessage: '–¶–µ–π –≤—ñ–¥—Ä—ñ–∑–æ–∫ –±—É–¥–µ –≤–∏–¥–∞–ª–µ–Ω–æ –Ω–∞–∑–∞–≤–∂–¥–∏.',
      deleteConfirm: '–í–∏–¥–∞–ª–∏—Ç–∏',
      deleteCancel: '–°–∫–∞—Å—É–≤–∞—Ç–∏',
      editBlockedTitle: '–ü–æ—Ä—è–¥–æ–∫ –≤—ñ–¥—Ä—ñ–∑–∫—ñ–≤',
      editBlockedMessage: '–°–ø–æ—á–∞—Ç–∫—É –∑–º—ñ–Ω—é–π –æ—Å—Ç–∞–Ω–Ω—ñ–π –≤—ñ–¥—Ä—ñ–∑–æ–∫, —â–æ–± –Ω–µ –ª–∞–º–∞—Ç–∏ –ª–∞–Ω—Ü—é–∂–æ–∫.',
    },
    symbols: {
      plus: '+',
    },
    moods: {
      happy: 'üôÇ',
      neutral: 'üòê',
      sad: 'üòî',
      angry: 'üò†',
    },
    greeting: {
      wave: 'üëã',
    },
    onboarding: {
      title: '–í—ñ—Ç–∞—î–º–æ',
      subtitle: '–ù–∞–ª–∞—à—Ç—É–π–º–æ –±–∞–∑–æ–≤—ñ —Ä–µ—á—ñ –ø–µ—Ä–µ–¥ —Å—Ç–∞—Ä—Ç–æ–º.',
      welcomeTitle: 'Weivo - —Ü–µ —Ç–≤—ñ–π –ø–æ—Ç—ñ–∫ –≤–∞–≥–∏.',
      welcomeBody:
        '–ü—Ä–∏–≤—ñ—Ç! –†–∞–¥—ñ—é, —â–æ —Ç–∏ —Ç—É—Ç. –¶–µ –ø–µ—Ä—à–∞ –≤–µ—Ä—Å—ñ—è, –¥–∞–ª—ñ –±—É–¥–µ –±—ñ–ª—å—à–µ. –î—è–∫—É—é, —â–æ –ø—Ä–æ–±—É—î—à ‚Äî –±—É–¥—É —Ä–∞–¥–∏–π —Ç–≤–æ—ó–º –≤—ñ–¥–≥—É–∫–∞–º —Ç–∞ —ñ–¥–µ—è–º, —ñ –ø–æ—Å—Ç–∞—Ä–∞—é—Å—è –≤—Ç—ñ–ª–∏—Ç–∏ —ó—Ö —É –Ω–∞—Å—Ç—É–ø–Ω–∏—Ö –æ–Ω–æ–≤–ª–µ–Ω–Ω—è—Ö.',
      welcomeExtra:
        '–¶—è –∞–ø–∫–∞ –¥–æ–ø–æ–º–æ–∂–µ –≤—ñ–¥—Å—Ç–µ–∂—É–≤–∞—Ç–∏ –≤–∞–≥—É —Ç–∞–∫, —â–æ–± –∑–∞–ª–∏—à–∞—Ç–∏—Å—è –º–æ—Ç–∏–≤–æ–≤–∞–Ω–∏–º —ñ —Ä—É—Ö–∞—Ç–∏—Å—è –¥–æ —Å–≤–æ—ó—Ö —Ü—ñ–ª–µ–π.',
      ageTitle: '–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è.',
      ageBody:
        '–î–ª—è —Ç–æ—á–Ω—ñ—à–∏—Ö —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤ ‚Äî —ñ, –º–æ–∂–ª–∏–≤–æ, —â–æ–± –ø—Ä–∏–≤—ñ—Ç–∞—Ç–∏ —Ç–µ–±–µ –∑ –¥–Ω–µ–º –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è.',
      birthDate: '–î–∞—Ç–∞ –Ω–∞—Ä–æ–¥–∂–µ–Ω–Ω—è',
      birthDatePlaceholder: '–û–±–µ—Ä—ñ—Ç—å –¥–∞—Ç—É',
      birthDateHelper: '–õ–∏—à–µ –¥–ª—è —Ä–æ–∑—Ä–∞—Ö—É–Ω–∫—ñ–≤, –Ω–µ –ø–µ—Ä–µ–¥–∞—î–º–æ.',
      sex: '–°—Ç–∞—Ç—å',
      bodyTitle: '–ü–∞—Ä–∞–º–µ—Ç—Ä–∏ —Ç—ñ–ª–∞.',
      bodyBody:
        '–©–æ–± –º–∞–∫—Å–∏–º–∞–ª—å–Ω–æ —Ç–æ—á–Ω–æ –ø–æ—Ä–∞—Ö—É–≤–∞—Ç–∏ —Ç—Ä–µ–Ω–¥–∏ –π —Ü—ñ–ª—ñ, –ø–æ–¥—ñ–ª–∏—Å—å —Ü–∏–º–∏ –¥–∞–Ω–∏–º–∏ —Ç–∞ —Ä—ñ–≤–Ω–µ–º –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ –Ω–∏–∂—á–µ.',
      height: '–ó—Ä—ñ—Å—Ç',
      weight: '–ü–æ—Ç–æ—á–Ω–∞ –≤–∞–≥–∞',
      bodyHelper: '–ó–∞–≤–∂–¥–∏ –º–æ–∂–Ω–∞ –∑–º—ñ–Ω–∏—Ç–∏ –ø—ñ–∑–Ω—ñ—à–µ.',
      activityHint: '–ü—Ä–æ–∫—Ä—É—Ç—å –Ω–∏–∂—á–µ, —Ç–∞–º —Ä—ñ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ.',
      goalTitle: '–Ø–∫–∞ —Ç–≤–æ—è —Ü—ñ–ª—å?',
      goalBody: '–û–±–µ—Ä–∏ –Ω–∞–ø—Ä—è–º —ñ –∫–æ–º—Ñ–æ—Ä—Ç–Ω–∏–π —Ç–µ–º–ø –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.',
      goalType: '–¢–∏–ø —Ü—ñ–ª—ñ',
      targetWeight: '–¶—ñ–ª—å–æ–≤–∞ –≤–∞–≥–∞',
      weeklyPace: '–¢–µ–º–ø –∑–∞ —Ç–∏–∂–¥–µ–Ω—å',
      weeklyPaceLoseHelper: '–î–æ 1.0 –∫–≥ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.',
      weeklyPaceGainHelper: '–î–æ 0.5 –∫–≥ –Ω–∞ —Ç–∏–∂–¥–µ–Ω—å.',
      targetRange: '–¶—ñ–ª—å–æ–≤–∏–π –¥—ñ–∞–ø–∞–∑–æ–Ω',
      activity: '–†—ñ–≤–µ–Ω—å –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—ñ',
      next: '–î–∞–ª—ñ',
      back: '–ù–∞–∑–∞–¥',
      finish: '–ì–æ—Ç–æ–≤–æ',
      stepLabel: '–ö—Ä–æ–∫ {current} –∑ {total}',
    },
  },
  es: {
    appName: 'Weivo',
    tabs: {
      profile: 'Perfil',
      home: 'Inicio',
      explore: 'Registros',
      add: 'A√±adir',
    },
    profile: {
      title: 'Perfil',
      subtitle: 'Datos personales, objetivos y m√©tricas de salud.',
      edit: 'Editar',
      sections: {
        basics: 'B√°sico',
        metrics: 'M√©tricas de salud',
        goal: 'Objetivo',
        preferences: 'Preferencias',
        support: 'Soporte',
        segments: 'Tramos',
      },
      fields: {
        birthDate: 'Fecha de nacimiento',
        sex: 'Sexo',
        age: 'Edad',
        height: 'Altura',
        currentWeight: 'Peso actual',
        bmi: 'IMC',
        calories: 'Calor√≠as',
        caloriesMaintenance: 'Mantenimiento',
        caloriesTarget: 'Objetivo',
        activity: 'Actividad',
        goalType: 'Tipo de objetivo',
        goalTarget: 'Peso objetivo',
        goalRate: 'Ritmo semanal',
        goalRange: 'Rango objetivo',
        prediction: 'Predicci√≥n',
        units: 'Unidades',
        language: 'Idioma',
        theme: 'Tema',
        feedback: 'Comentarios',
      },
      actions: {
        addSegment: 'A√±adir',
      },
      values: {
        notSet: 'Sin configurar',
        unitsMetric: 'M√©trico (kg, cm)',
        unitsImperial: 'Imperial (lb, ft)',
        languageSoon: 'Pronto',
        languageSystem: 'Sistema',
        themeSoon: 'Pronto',
        themeLight: 'Claro',
        themeDark: 'Oscuro',
        themeRose: 'Rosa',
        themeSky: 'Cielo',
        themeMint: 'Menta',
        goalLose: 'Perder peso',
        goalGain: 'Ganar peso',
        goalMaintain: 'Mantener',
        feedbackLink: 'Telegram',
        sexMale: 'Hombre',
        sexFemale: 'Mujer',
        caloriesMaintenance: 'Mantenimiento',
        caloriesTarget: 'Objetivo',
        inRange: 'En rango',
        activitySedentary: 'Sed',
        activityLight: 'Lig',
        activityModerate: 'Mod',
        activityActive: 'Act',
        activityVeryActive: 'Muy',
        activitySedentaryDesc: 'Trabajo de oficina, m√≠nimo movimiento.',
        activityLightDesc: 'Caminatas ligeras 1‚Äì2 veces por semana.',
        activityModerateDesc: 'Entrenamiento 2‚Äì3 veces por semana.',
        activityActiveDesc: 'Entrenamiento 4‚Äì5 veces por semana.',
        activityVeryActiveDesc: 'Entrenamiento intenso o trabajo f√≠sico.',
      },
    },
    profileEdit: {
      title: 'Editar perfil',
      subtitle: 'Actualiza tus datos y objetivos.',
      tabs: {
        profile: 'Perfil',
        account: 'Cuenta',
      },
      birthDate: 'Fecha de nacimiento',
      birthDatePlaceholder: 'Selecciona fecha',
      sex: 'Sexo',
      height: 'Altura (cm)',
      activity: 'Nivel de actividad',
      goalType: 'Tipo de objetivo',
      goalTarget: 'Peso objetivo',
      goalRate: 'Ritmo',
      goalRange: 'Rango objetivo (kg)',
      units: 'Unidades',
      language: 'Idioma',
      theme: 'Tema',
      themeOptions: {
        light: 'Claro',
        dark: 'Osc',
        rose: 'Rosa',
        sky: 'Cielo',
        mint: 'Menta',
      },
      currentWeight: 'Actual',
      save: 'Guardar',
      cancel: 'Cancelar',
    },
    modal: {
      title: 'Nuevo registro',
      subtitle: 'Agrega el valor de hoy y el √°nimo opcional.',
      placeholderWeight: '0.0',
      moodLabel: '√Ånimo (opcional)',
      cancel: 'Cancelar',
      save: 'Guardar',
      addEntryTitle: 'A√±adir registro',
    },
    home: {
      tagline: 'Tu peso: constante, honesto, real',
      currentWeight: 'Peso actual',
      trendingDown: 'Bajando',
      trendingUp: 'Subiendo',
      lowest: 'M√≠nimo',
      highest: 'M√°ximo',
      entries: 'Registros',
      deltaSuffix: 'kg / 10 d√≠as',
      goal: 'Objetivo',
      eta: 'ETA',
      bmi: 'IMC',
      segmentsHintTitle: 'Tramos de objetivo',
      segmentsHintBody:
        'Divide tu objetivo en pasos peque√±os. Mant√©n el foco y sigue el progreso con claridad. Crea tu primer tramo ahora o m√°s tarde en Perfil.',
      segmentsHintCta: 'Crear primer tramo',
      segmentsHintDismiss: 'M√°s tarde',
      units: {
        kg: 'kg',
        days: 'd√≠as',
        weeksShort: 'sem',
      },
    },
    chart: {
      title: 'Flujo de peso',
      subtitleSuffix: 'd√≠as - registro diario',
      start: 'Inicio',
      latest: '√öltimo',
      unit: 'kg',
    },
    entries: {
      title: 'Todos los registros',
      recordsSuffix: 'registros',
      dailyLog: 'Registro diario',
      deltaZero: '0.0',
      unit: 'kg',
      clearAll: 'Borrar todo',
      clearAllTitle: '¬øBorrar todos los registros?',
      clearAllMessage: 'Esto eliminar√° todos los pesajes guardados.',
      clearAllConfirm: 'Borrar',
      clearAllCancel: 'Cancelar',
      deleteTitle: '¬øEliminar registro?',
      deleteMessage: 'Este registro se eliminar√° permanentemente.',
      deleteConfirm: 'Eliminar',
      deleteCancel: 'Cancelar',
    },
    segments: {
      createTitle: 'Nuevo tramo',
      createSubtitle: 'Divide tu objetivo en pasos claros.',
      done: 'Listo',
      direction: 'Direcci√≥n',
      mode: 'Modo',
      modeDelta: 'Por kg',
      modeTarget: 'Peso objetivo',
      modeHelper: 'Elige c√≥mo quieres definir este paso.',
      startWeight: 'Peso inicial',
      delta: 'Cambio',
      targetWeight: 'Peso objetivo',
      note: 'Nota (opcional)',
      notePlaceholder: 'Ejemplo: este era mi peso hace 4 a√±os',
      save: 'Guardar',
      cancel: 'Cancelar',
      empty: 'A√∫n no hay tramos',
      detailTitle: 'Tramo',
      detailSubtitle: 'Actualiza o elimina este tramo.',
      detailMissing: 'Tramo no encontrado.',
      completedTitle: 'Tramo completado',
      completedMessage: 'Los tramos completados son solo de lectura.',
      deleteTitle: '¬øEliminar tramo?',
      deleteMessage: 'Este tramo se eliminar√° permanentemente.',
      deleteConfirm: 'Eliminar',
      deleteCancel: 'Cancelar',
      editBlockedTitle: 'Orden de tramos',
      editBlockedMessage: 'Primero actualiza el √∫ltimo tramo para no romper la cadena.',
    },
    symbols: {
      plus: '+',
    },
    moods: {
      happy: 'üôÇ',
      neutral: 'üòê',
      sad: 'üòî',
      angry: 'üò†',
    },
    greeting: {
      wave: 'üëã',
    },
    onboarding: {
      title: 'Bienvenido',
      subtitle: 'Configuremos lo esencial antes de empezar.',
      welcomeTitle: 'Weivo es tu flujo de peso.',
      welcomeBody:
        '¬°Hola! Me alegra que est√©s aqu√≠. Esta es la primera versi√≥n y habr√° m√°s. Gracias por probarla ‚Äî agradecer√© tus comentarios e ideas, y har√© lo posible por convertirlos en mejoras.',
      welcomeExtra:
        'Esta app te ayuda a seguir tu peso y mantenerte motivado para alcanzar tus objetivos.',
      ageTitle: 'Tu fecha de nacimiento.',
      ageBody:
        'Para c√°lculos m√°s precisos ‚Äî y quiz√° para felicitarte en tu cumplea√±os.',
      birthDate: 'Fecha de nacimiento',
      birthDatePlaceholder: 'Selecciona fecha',
      birthDateHelper: 'Solo para c√°lculos, no se comparte.',
      sex: 'Sexo',
      bodyTitle: 'M√©tricas corporales.',
      bodyBody:
        'Para calcular tus tendencias y objetivos con precisi√≥n, comparte estos datos y tu nivel de actividad abajo.',
      height: 'Altura',
      weight: 'Peso actual',
      bodyHelper: 'Puedes actualizarlo cuando quieras.',
      activityHint: 'Despl√°zate hacia abajo para el nivel de actividad.',
      goalTitle: '¬øCu√°l es tu objetivo?',
      goalBody: 'Elige una meta y un ritmo semanal sostenible.',
      goalType: 'Tipo de meta',
      targetWeight: 'Peso objetivo',
      weeklyPace: 'Ritmo semanal',
      weeklyPaceLoseHelper: 'Hasta 1.0 kg por semana.',
      weeklyPaceGainHelper: 'Hasta 0.5 kg por semana.',
      targetRange: 'Rango objetivo',
      activity: 'Nivel de actividad',
      next: 'Siguiente',
      back: 'Atr√°s',
      finish: 'Finalizar',
      stepLabel: 'Paso {current} de {total}',
    },
  },
};

export type Texts = typeof translations.en;

export const localeLabels: Record<Locale, string> = {
  en: 'English',
  uk: '–£–∫—Ä–∞—ó–Ω—Å—å–∫–∞',
  es: 'Espa√±ol',
};

const initLocale = getSystemLocale();

if (!i18n.isInitialized) {
  i18n.use(initReactI18next).init({
    compatibilityJSON: 'v4',
    resources: {
      en: { translation: translations.en },
      uk: { translation: translations.uk },
      es: { translation: translations.es },
    },
    lng: initLocale,
    fallbackLng: DEFAULT_LOCALE,
    interpolation: {
      escapeValue: false,
    },
  });
}

export const useTexts = () => {
  const { i18n: i18nInstance } = useTranslation();
  const texts = useMemo(() => {
    const bundle = i18nInstance.getResourceBundle(i18nInstance.language, 'translation');
    return (bundle ?? translations.en) as Texts;
  }, [i18nInstance.language]);
  return { texts, locale: i18nInstance.language };
};

export const useI18nSync = (language?: LanguageOption) => {
  useEffect(() => {
    const nextLocale =
      language && language !== 'system' ? normalizeLocale(language) : getSystemLocale();
    if (i18n.language !== nextLocale) {
      void i18n.changeLanguage(nextLocale);
    }
  }, [language]);
};

export default i18n;
